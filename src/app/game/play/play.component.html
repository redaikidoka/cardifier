<cf-navbar></cf-navbar>
<main class="h-full w-full" style="background-color: rgba(0, 0, 0, 0.8)">
  <section *ngIf="game$ | async as game; else no_game" class="pt-16 pb-32">
    <!-- <h1 class="text-white font-semibold text-2xl mb-6">Home Page</h1> -->

    <!-- Game & Session -->
    <div class="flex flex-row flex-wrap" style="background-color: rgba(0, 0, 0, 0.3)">
      <!-- game -->
      <div class="md:w-1/2 w-full pr-4 ">
        <app-area-title [titleText]="game.gameTitle" [iconUrl]="game?.iconUrl"></app-area-title>
        <span class="block text-gray-200 ml-8 mt-2"> Hours played: {{game.hoursPlayed}}</span>

        <app-hand-blocks *ngIf="hand$ | async as hand44" [hand]="hand44"></app-hand-blocks>
      </div>
      <!-- session -->
      <div class="md:w-1/2 w-full ">
        <ng-container *ngIf="game?.currentSession; else no_session">
          <h2 class="align-middle text-gray-300 font-semibold text-xl mt-3 mb-2 ml-2">
            <em class="text-lg text-purple-400" matTooltip="Session {{game.currentSession?.sessionNumber}}"> {{game.currentSession?.sessionTitle}} </em>
          </h2>
          <button class="text-sm m-1 p-1 bg-purple-300 text-gray-600 rounded-lg float-right"
                  (click)="createSessionHand(game.currentSession)">
            <i class="fas fa-plus"></i>
            Hand
          </button>
          <!--          <ng-container *ngIf="game.currentSession?.hands" -->
          <div *ngFor="let hand of game.currentSession?.hands" class="w-full">
            <app-hand-blocks [hand]="hand"></app-hand-blocks>
          </div>
        </ng-container>
        <ng-template #no_session>
          <button>Start New Session</button>

        </ng-template>

      </div>
    </div>

    <!-- play-character / sidebar -->
    <div class="flex flex-row flex-wrap h-100">
      <!-- play -->
      <div class="lg:w-3/4 w-full backdrop-grayscale ">
        <div class="flex flex-row flex-wrap ">
          <!--          &lt;!&ndash; bg &ndash;&gt;-->
          <!--          <div *ngIf="game.imageUrl" class="absolute lg:w-3/4 w-full  border-4 border-blue-500 ">-->
          <!--            <img class="w-full object-cover rounded-xl filter brightness-50 saturate-50 bg-cover overflow-clip"-->
          <!--                 src="{{game.imageUrl}}" alt=""/>-->
          <!--          </div>-->
          <!--          &lt;!&ndash; content &ndash;&gt;-->
          <!--          <div class="relative h-full w-full flex border-4 border-green-500">-->
          <!--            <h2 class="text-gray-300">play area</h2>-->
          <!--          </div>-->
          <!-- row -->
          <div class="w-full  bg-cover h-min-300 bg-opacity-25"
               [ngStyle]="{'background-image': 'url(' + game?.imageUrl + ')'}">
            <!--            <div class=""-->
            <h2 class="text-gray-200 ml-2">{{game?.playArea?.areaTitle}}</h2>
            <div class="flex flex-row flex-wrap content-center">
              <div *ngFor="let hand of game.playArea?.hands" class="flex flex-col m:w-1/4 xs:w-full">
                <app-hand-blocks [hand]="hand" [titleSize]="' block text-xl bg-gray-700'"
                                 [bgStyle]="' bg-gray-800 bg-opacity-25'"
                                 [cardStyle]="'block bg-gray-800 text-white ml-4'"></app-hand-blocks>
              </div>
            </div>
          </div>
        </div>
        <!-- characters -->
        <div class="flex flex-row flex-wrap">
          <div class="w-full border-green-400 border-4">
            <div *ngFor="let character of game.characters">
              <h4 class="text-green-400 font-semibold"
                  matTooltip="{{character.characterDescription}}"> {{character.characterName}}</h4>
              <div *ngFor="let hand of character.hands | handType: 'dropdown'" class="float-right">
                <app-hand-dropdown [hand]="hand" [titleSize]="' block text-xl bg-gray-700'"
                                   [bgStyle]="' bg-gray-800 bg-opacity-50'"
                                   [cardStyle]="'block bg-gray-800 text-white ml-4'"></app-hand-dropdown>
              </div>
              <div *ngFor="let hand of character.hands" class="flex-col md:w-1/4 w-full">
                <app-hand-blocks [hand]="hand" [titleSize]="'w-full block text-xl bg-gray-700'"
                                 [bgStyle]="' bg-gray-800 bg-opacity-25'"
                                 [cardStyle]="'block bg-gray-800 text-white ml-4'"></app-hand-blocks>
              </div>
            </div>
          </div>
        </div>

      </div>
      <!-- chat -->
      <div class="lg:w-1/4 w-full ">
        <mat-tab-group >
          <mat-tab class="bg-white text-white">
            <ng-template mat-tab-label>
              <i class="fa fa-comment mr-1"></i> Chat

            </ng-template>
            <div class="overflow-y-scroll h-full">
              <app-chat-list [chats$]="chats$"></app-chat-list>
            </div>
          </mat-tab>
          <mat-tab label="Toolbox">
            Todo...
          </mat-tab>
        </mat-tab-group>


      </div>
    </div>
  </section>
  <ng-template #no_game>
    <section class="pt-16 pb-32">
      <h1 class="font-bold text-3xl text-white text-center"> Please return to the
        <a [routerLink]="'/home'" class="text-blue-700">home page </a>
        ; this game did not load.
      </h1>
    </section>
  </ng-template>
<!--  <cf-footer></cf-footer>-->
</main>
